<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HR Compliance Game</title>
    <link rel="stylesheet" href="index.css">
    <script type="module" src="./gameComponents/guidebook.js"></script>
    <script type="module" src="./3dOffice/setup.js"></script>
    <script type="module" src="./3dOffice/main.js"></script>
</head>

<body>
<!-- Introductory overlay with Learning Objective -->
<div id="intro-screen">
    <h1>HR Compliance Investigation</h1>
    <p><strong>Learning Objective:</strong> In this case, you will learn how to identify workplace harassment, collect proper evidence, and take appropriate action.</p>

    <p>
        The HR department has received a complaint that an employee has been sending inappropriate and threatening messages.
    </p>
    <p>
        Your task as an investigator is to analyze the case, gather necessary evidence, and make the correct compliance decision.
    </p>

    <button id="start-button">Start and Learn</button>
</div>

<!-- The Three.js canvas -->
<canvas class="webgl"></canvas>

<!-- Chat Bubble Container -->
<div class="chat-container" id="chat-container"></div>

<!-- Inline script to remove the intro overlay -->
<script type="module">
    import { showVictimNarrationNearNPC } from './3dOffice/main.js';

    document.getElementById('start-button').addEventListener('click', () => {
        document.getElementById('intro-screen').style.display = 'none';
        showVictimNarrationNearNPC();

    });
</script>

<!-- Evidence UI -->
<button id="evidence-icon" class="action-button evidence-icon">üóÇÔ∏è Evidence</button>
<div id="evidence-container" class="evidence-container" style="display: none;">
    <h3>Collected Evidence</h3>
    <ul id="evidence-list"></ul>
</div>

<!-- Submit Investigation Report Button -->
<button id="submit-report" class="action-button submit-report-button">Submit Investigation Report</button>

<!-- Report Modal (Initially Hidden) -->
<div id="report-modal" class="modal-overlay" style="display: none;">
    <div class="modal-content">
        <h2 id="modal-title">Investigation Report</h2>

        <!-- Step 1: Choose Suspect & Explanation -->
        <div id="report-step-1">
            <label for="suspect-selection"><strong>Select the Culprit:</strong></label>
            <select id="suspect-selection">
                <option value="">-- Select a suspect --</option>
                <option value="Amy">Amy</option>
                <option value="Bill">Bill</option>
                <option value="Alex">Alex</option>
                <option value="Emily">Emily</option>
            </select>

            <label for="detective-reason"><strong>Why do you think they are the culprit?</strong></label>
            <textarea id="detective-reason" placeholder="Explain your reasoning... (Optional)"></textarea>

            <button id="submit-suspect">Submit Report</button>
            <button id="close-report-modal">Close</button>
        </div>

        <!-- Step 2: AI Generating Report -->
        <p id="report-status" style="display: none;">Generating report, please wait...</p>

        <!-- Step 3: Display AI-Generated Report -->
        <div id="report-content" style="display: none;"></div>

        <!-- End Game Button (Initially Hidden) -->
        <button id="end-game" style="display: none;">End Game</button>
    </div>
</div>


<!-- Compliance Guidebook Button -->
<button id="open-guidebook" class="action-button guidebook-button">üìñ HR Compliance Guidebook</button>

<!-- Guidebook Modal (Initially Hidden) -->
<div id="guidebook-modal" class="modal-overlay" style="display: none;">
    <div class="modal-content">
        <h2>HR & Anti-Harassment Guidebook</h2>
        <p><strong>Select a topic to learn more:</strong></p>

        <select id="guidebook-topic">
            <option value="harassment" selected>Understanding Workplace Harassment</option>
            <option value="types_harassment">Types of Harassment</option>
            <option value="reporting">Reporting & Investigation Procedures</option>
            <option value="company_policy">Company Policies & Employee Rights</option>
            <option value="bystander_intervention">Bystander Intervention</option>
        </select>

        <div id="guidebook-content">
            <p>Select a topic to view details.</p>
        </div>

        <button id="close-guidebook">Close</button>
    </div>
</div>

<script>
    document.getElementById("close-report-modal").addEventListener("click", function () {
        document.getElementById("report-modal").style.display = "none";
    });
</script>
</body>
</html>
